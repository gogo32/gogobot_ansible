#!/bin/bash

# Directory paths
APP_DIR="{{ app_dir }}"
BACKUP_DIR="{{ backup_dir }}"
GIT_REPO="{{ git_repo }}"

# Step 1: Rename the current directory
echo "Renaming the current app directory..."
if [ -d "$APP_DIR" ]; then
    mv $APP_DIR $BACKUP_DIR
else
    echo "$APP_DIR does not exist, skipping rename..."
fi

# Step 2: Create a new current directory
echo "Creating a new current app directory..."
mkdir -p $APP_DIR

# Step 3: Git clone to get the most recent files in the current directory
echo "Cloning the repository..."
git clone $GIT_REPO $APP_DIR

echo "Deployment completed successfully."
